<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PoE åŒè·¯å¾„å¥—åˆ©è®¡ç®—å™¨ï¼ˆå«è·¯å¾„ A/Bï¼‰</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 960px;
      margin: 20px auto;
      padding: 20px;
      background-color: #f8f9fa;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 25px;
    }
    .container {
      display: flex;
      gap: 20px;
      margin-bottom: 25px;
    }
    .panel {
      flex: 1;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }
    .panel-title {
      text-align: center;
      font-weight: bold;
      margin-bottom: 15px;
      color: #2980b9;
      font-size: 18px;
    }
    .step {
      margin-bottom: 14px;
    }
    label {
      display: block;
      font-size: 14px;
      color: #555;
      margin-bottom: 5px;
    }
    .input-group {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    input {
      width: 90px;
      padding: 6px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(to right, #3498db, #2980b9);
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      opacity: 0.9;
    }
    #result {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      margin-top: 20px;
    }
    .profit { color: #27ae60; font-weight: bold; }
    .loss { color: #e74c3c; }
    .info {
      font-size: 13px;
      color: #7f8c8d;
      margin-top: 15px;
      line-height: 1.5;
    }
  </style>
<title>PoE åŒè·¯å¾„å¥—åˆ©è®¡ç®—å™¨</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’°</text></svg>">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Path of Exile åŒè·¯å¾„å¥—åˆ©è®¡ç®—å™¨ï¼šè‡ªåŠ¨è®¡ç®—æ··æ²ŒçŸ³ â†” ç¥åœ£çŸ³åŒå‘åˆ©æ¶¦ï¼Œæ”¯æŒæœ€å°æ•´æ•°å¯è¡Œæ–¹æ¡ˆã€‚">
</head>
<body>
  <h1>ğŸ”„ Path of Exile è‡ªå®šä¹‰ä¸‰æ­¥å¥—åˆ©è®¡ç®—å™¨</h1>

  <div class="container">
    <!-- è·¯å¾„ A -->
    <div class="panel">
      <div class="panel-title">ğŸ” è·¯å¾„ Aï¼šæ··æ²Œ â†’ é¢„å…† â†’ ç¥åœ£ â†’ æ··æ²Œ</div>
      <div class="step">
        <label>1. èŠ± [ ] æ··æ²Œ â†’ å¾— [ ] é¢„å…†</label>
        <div class="input-group">
          <input type="number" id="a_spend1" value="190" step="any"> 
          <span>â†’</span>
          <input type="number" id="a_get1" value="1" step="any">
        </div>
      </div>
      <div class="step">
        <label>2. èŠ± [ ] é¢„å…† â†’ å¾— [ ] ç¥åœ£</label>
        <div class="input-group">
          <input type="number" id="a_spend2" value="1" step="any">
          <span>â†’</span>
          <input type="number" id="a_get2" value="9" step="any">
        </div>
      </div>
      <div class="step">
        <label>3. èŠ± [ ] ç¥åœ£ â†’ å¾— [ ] æ··æ²Œ</label>
        <div class="input-group">
          <input type="number" id="a_spend3" value="1" step="any">
          <span>â†’</span>
          <input type="number" id="a_get3" value="20" step="any">
        </div>
      </div>
    </div>

    <!-- è·¯å¾„ B -->
    <div class="panel">
      <div class="panel-title">ğŸ” è·¯å¾„ Bï¼šç¥åœ£ â†’ é¢„å…† â†’ æ··æ²Œ â†’ ç¥åœ£</div>
      <div class="step">
        <label>1. èŠ± [ ] ç¥åœ£ â†’ å¾— [ ] é¢„å…†</label>
        <div class="input-group">
          <input type="number" id="b_spend1" value="9" step="any">
          <span>â†’</span>
          <input type="number" id="b_get1" value="1" step="any">
        </div>
      </div>
      <div class="step">
        <label>2. èŠ± [ ] é¢„å…† â†’ å¾— [ ] æ··æ²Œ</label>
        <div class="input-group">
          <input type="number" id="b_spend2" value="1" step="any">
          <span>â†’</span>
          <input type="number" id="b_get2" value="190" step="any">
        </div>
      </div>
      <div class="step">
        <label>3. èŠ± [ ] æ··æ²Œ â†’ å¾— [ ] ç¥åœ£</label>
        <div class="input-group">
          <input type="number" id="b_spend3" value="20" step="any">
          <span>â†’</span>
          <input type="number" id="b_get3" value="1" step="any">
        </div>
      </div>
    </div>
  </div>

  <button onclick="calculateAll()">ğŸ§® è®¡ç®—åŒå‘å¥—åˆ©ï¼ˆå«ç†è®ºåˆ©æ¶¦ï¼‰</button>

  <div id="result"></div>

  <div class="info">
    <p><strong>ä½¿ç”¨è¯´æ˜ï¼š</strong></p>
    <ul>
      <li>æ¯è¡Œè¡¨ç¤ºï¼š<strong>â€œèŠ± X [é€šè´§] â†’ å¾— Y [é€šè´§]â€</strong></li>
      <li>è·¯å¾„ Aï¼šä»æ··æ²Œå‡ºå‘ï¼Œæœ€ç»ˆæ¢å›æ··æ²Œï¼›è·¯å¾„ Bï¼šä»ç¥åœ£å‡ºå‘ï¼Œæœ€ç»ˆæ¢å›ç¥åœ£</li>
      <li>å·¥å…·å…ˆè®¡ç®—ç†è®ºåˆ©æ¶¦ç‡ï¼Œå†æœç´¢ k=1~1000 çš„æœ€å°æ•´æ•°å¯è¡Œæ–¹æ¡ˆ</li>
      <li>åˆ©æ¶¦ â‰¥1 ä¸ªèµ·å§‹é€šè´§æ‰è§†ä¸ºæœ‰æ•ˆå¥—åˆ©</li>
    </ul>
  </div>

  <script>
    function isPositiveNumber(x) {
      return !isNaN(x) && x > 0;
    }

    function calculatePath(s1, g1, s2, g2, s3, g3, startName) {
      if (!isPositiveNumber(s1) || !isPositiveNumber(g1) ||
          !isPositiveNumber(s2) || !isPositiveNumber(g2) ||
          !isPositiveNumber(s3) || !isPositiveNumber(g3)) {
        return { error: 'è¾“å…¥æ— æ•ˆ' };
      }

      // ç†è®ºäº§å‡ºï¼ˆæ¯ 1 å•ä½èµ·å§‹é€šè´§ï¼‰
      const theoreticalOutput = (g1 / s1) * (g2 / s2) * (g3 / s3);
      const profitRate = theoreticalOutput - 1;

      const result = {
        theoreticalOutput,
        profitRate,
        feasible: null
      };

      if (profitRate <= 0) {
        return result;
      }

      // å°è¯• k = 1 åˆ° 1000
      for (let k = 1; k <= 1000; k++) {
        const inputStart = k * s1;
        const prophecy = k * g1;
        // Step 2: é¢„å…†å¿…é¡»èƒ½è¢« s2 æ•´é™¤
        if (Math.abs(prophecy % s2) > 1e-9) continue;
        const groups2 = prophecy / s2;
        const middle = groups2 * g2; // ç¥åœ£ï¼ˆè·¯å¾„Aï¼‰æˆ–æ··æ²Œï¼ˆè·¯å¾„Bï¼‰
        // Step 3: middle å¿…é¡»èƒ½è¢« s3 æ•´é™¤
        if (Math.abs(middle % s3) > 1e-9) continue;
        const groups3 = middle / s3;
        const outputStart = groups3 * g3;
        const profit = outputStart - inputStart;

        if (profit >= 1) {
          result.feasible = {
            k,
            input: inputStart,
            prophecy,
            middle,
            output: outputStart,
            profit
          };
          break;
        }
      }

      return result;
    }

    function formatNumber(x) {
      return Math.abs(x - Math.round(x)) < 1e-6 ? Math.round(x) : parseFloat(x.toFixed(6));
    }

    function calculateAll() {
      // è·¯å¾„ A è¾“å…¥
      const a_s1 = parseFloat(document.getElementById('a_spend1').value);
      const a_g1 = parseFloat(document.getElementById('a_get1').value);
      const a_s2 = parseFloat(document.getElementById('a_spend2').value);
      const a_g2 = parseFloat(document.getElementById('a_get2').value);
      const a_s3 = parseFloat(document.getElementById('a_spend3').value);
      const a_g3 = parseFloat(document.getElementById('a_get3').value);

      // è·¯å¾„ B è¾“å…¥
      const b_s1 = parseFloat(document.getElementById('b_spend1').value);
      const b_g1 = parseFloat(document.getElementById('b_get1').value);
      const b_s2 = parseFloat(document.getElementById('b_spend2').value);
      const b_g2 = parseFloat(document.getElementById('b_get2').value);
      const b_s3 = parseFloat(document.getElementById('b_spend3').value);
      const b_g3 = parseFloat(document.getElementById('b_get3').value);

      const resA = calculatePath(a_s1, a_g1, a_s2, a_g2, a_s3, a_g3, 'æ··æ²Œ');
      const resB = calculatePath(b_s1, b_g1, b_s2, b_g2, b_s3, b_g3, 'ç¥åœ£');

      let html = '<h3>ğŸ“Š è®¡ç®—ç»“æœ</h3>';

      // è·¯å¾„ A
      html += `<h4>è·¯å¾„ Aï¼ˆæ··æ²Œ â†’ é¢„å…† â†’ ç¥åœ£ â†’ æ··æ²Œï¼‰</h4>`;
      html += `ç†è®ºåˆ©æ¶¦ç‡: ${(resA.profitRate * 100).toFixed(3)}% ï¼ˆ1 æ··æ²Œ â†’ ${formatNumber(resA.theoreticalOutput)} æ··æ²Œï¼‰<br>`;
      if (resA.profitRate <= 0) {
        html += '<span class="loss">âŒ æ— å¥—åˆ©ç©ºé—´</span>';
      } else if (resA.feasible) {
        const f = resA.feasible;
        html += `
          <span class="profit">âœ… æ‰¾åˆ°æ•´æ•°æ–¹æ¡ˆï¼ˆk=${f.k}ï¼‰ï¼š</span><br>
          æŠ•å…¥ ${formatNumber(f.input)} æ··æ²Œ 
          â†’ ${formatNumber(f.prophecy)} é¢„å…† 
          â†’ ${formatNumber(f.middle)} ç¥åœ£ 
          â†’ ${formatNumber(f.output)} æ··æ²Œ<br>
          å‡€åˆ©æ¶¦ï¼š+${Math.round(f.profit)} æ··æ²ŒçŸ³
        `;
      } else {
        html += '<span class="loss">âš ï¸ ç†è®ºå¯ç›ˆåˆ©ï¼Œä½† kâ‰¤1000 å†…æ— æ•´æ•°è§£</span>';
      }

      html += '<hr style="margin:20px 0;border:0;border-top:1px dashed #ccc;">';

      // è·¯å¾„ B
      html += `<h4>è·¯å¾„ Bï¼ˆç¥åœ£ â†’ é¢„å…† â†’ æ··æ²Œ â†’ ç¥åœ£ï¼‰</h4>`;
      html += `ç†è®ºåˆ©æ¶¦ç‡: ${(resB.profitRate * 100).toFixed(3)}% ï¼ˆ1 ç¥åœ£ â†’ ${formatNumber(resB.theoreticalOutput)} ç¥åœ£ï¼‰<br>`;
      if (resB.profitRate <= 0) {
        html += '<span class="loss">âŒ æ— å¥—åˆ©ç©ºé—´</span>';
      } else if (resB.feasible) {
        const f = resB.feasible;
        html += `
          <span class="profit">âœ… æ‰¾åˆ°æ•´æ•°æ–¹æ¡ˆï¼ˆk=${f.k}ï¼‰ï¼š</span><br>
          æŠ•å…¥ ${formatNumber(f.input)} ç¥åœ£ 
          â†’ ${formatNumber(f.prophecy)} é¢„å…† 
          â†’ ${formatNumber(f.middle)} æ··æ²Œ 
          â†’ ${formatNumber(f.output)} ç¥åœ£<br>
          å‡€åˆ©æ¶¦ï¼š+${Math.round(f.profit)} ç¥åœ£çŸ³
        `;
      } else {
        html += '<span class="loss">âš ï¸ ç†è®ºå¯ç›ˆåˆ©ï¼Œä½† kâ‰¤1000 å†…æ— æ•´æ•°è§£</span>';
      }

      document.getElementById('result').innerHTML = html;
    }

    // åˆå§‹è®¡ç®—
    window.onload = calculateAll;
  </script>
</body>
</html>


